# This file contains base jobs for rpmfactory
# Any modification here will be overwritten
# by an upgrade of rpmfactory

- builder:
    name: prepare-rpmfactory-workspace
    builders:
      - shell: |
          # Set koji client identity
          echo "Set koji client identity"
          tar -xzf ${CLIENTSECRET} -C /home/jenkins/

- builder:
    name: 'base-pkg-validation'
    defaults: global
    builders:
      - prepare-rpmfactory-workspace
      - shell: |
          sudo yum -y install centos-packager createrepo
          git clone http://review.rdoproject.org/r/gating_scripts
          cd gating_scripts
          ./pkg-validate.sh {buildtarget} {kojicmd}

- builder:
    name: 'base-pkg-exportation'
    defaults: global
    builders:
      - prepare-rpmfactory-workspace
      - shell: |
          sudo yum -y install centos-packager createrepo
          git clone http://review.rdoproject.org/r/gating_scripts
          cd gating_scripts
          ./pkg-export.sh {buildtarget} {kojicmd}
