# This file won't be updated and must be updated manually
# Test

- job:
    name: 'packstack-validate'
    defaults: global
    builders:
      - base-pkg-validation:
          buildtarget: "cloud7-openstack-liberty-el7"
          kojicmd: "koji"
      - shell: |
          git clone http://review.rdoproject.org/r/rdo_gating_scripts
          cd rdo_gating_scripts
          validated="http://koji-rpmfactory.ring.enovance.com/kojifiles/repos/cloud7-openstack-liberty-el7-build/latest/x86_64/"
          ./run_packstack.sh /home/jenkins/rpmbuild/RPMS/noarch/rpmfactory-temp-release-1.0-1.noarch.rpm $validated
    triggers:
      - zuul
    wrappers:
      - credentials-binding:
        - file:
           credential-id: 86d1bd02-65b8-4fe9-906f-04cfcb68b13a
           variable: CLIENTSECRET
    node: rdo-centos7-liberty

- job:
    name: 'rpmlint-validate'
    defaults: global
    builders:
      - base-pkg-validation:
          buildtarget: "cloud7-openstack-liberty-el7"
          kojicmd: "koji"
      - shell: |
          sudo yum install -y rpmlint
          cd $ZUUL_PROJECT
          # Simple checks with infos
          rpmlint -iv *.spec
    triggers:
      - zuul
    wrappers:
      - credentials-binding:
        - file:
           credential-id: 86d1bd02-65b8-4fe9-906f-04cfcb68b13a
           variable: CLIENTSECRET
    node: rdo-centos7-liberty

- job:
    name: 'pkg-upgrade-validate'
    defaults: global
    builders:
      - base-pkg-validation:
          buildtarget: "cloud7-openstack-liberty-el7"
          kojicmd: "koji"
      - shell: |
          echo "Please add logic to test the package can be upgraded."
    triggers:
      - zuul
    wrappers:
      - credentials-binding:
        - file:
           credential-id: 86d1bd02-65b8-4fe9-906f-04cfcb68b13a
           variable: CLIENTSECRET
    node: rdo-centos7-liberty

- job:
    name: 'pkg-export'
    defaults: global
    builders:
      - base-pkg-exportation:
          buildtarget: "cloud7-openstack-liberty-el7"
          kojicmd: "koji"
      - shell: |
          echo "If displayed then package as been published (non-scratch)."
          echo "Nothing more to do. Exit 0."
    triggers:
      - zuul
    wrappers:
      - credentials-binding:
        - file:
           credential-id: 86d1bd02-65b8-4fe9-906f-04cfcb68b13a
           variable: CLIENTSECRET
    node: rdo-centos7-liberty
