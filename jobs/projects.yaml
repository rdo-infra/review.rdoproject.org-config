# This file won't be updated and must be updated manually

# Jobs
# ====

- job:
    name: 'pkg-validate'
    defaults: global
    builders:
      - prepare-workspace
      - shell: |
          env
          sudo yum install rsync
          git clone http://softwarefactory-project.io/r/rpmfactory
          rpmdev-setuptree
          cd $ZUUL_PROJECT
          rsync --exclude="*.spec" ./* ~/rpmbuild/SOURCES/
          spectool -g *.spec -C ~/rpmbuild/SOURCES
          rpmbuild -bs *.spec
          srpm=$(ls ~/rpmbuild/SRPMS/*.src.rpm)
          ~/rpmfactory/koji-build.sh $srpm
          sudo rpm -i ~/rpmbuild/RPMS/noarch/rdo-temp-release-1.0-1.noarch.rpm
          sudo yum install $ZUUL_PROJECT
    triggers:
      - zuul
    node: koji-centos-7

- job:
    name: 'pkg-validate2'
    defaults: global
    builders:
      - prepare-workspace
      - shell: |
          env

- job:
    name: 'tox-validate'
    defaults: global
    builders:
      - prepare-workspace
      - shell: |
          cd $ZUUL_PROJECT
          tox
    triggers:
      - zuul
    node: koji-centos-7

# Projects
# ========
- project:
    name: zuul-demo
    node: master
    jobs:
      - '{name}-unit-tests'
      - '{name}-functional-tests'
