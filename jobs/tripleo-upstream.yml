# Fill /etc/nodepool/provider with data as expected by tripleo-quickstart
# See: https://review.openstack.org/#/c/478211/
- builder:
    name: hack-nodepool-provider-setup
    builders:
      - shell: |
          #!/bin/sh
          cat <<EOF | sudo tee /etc/nodepool/provider
          NODEPOOL_PROVIDER=rdo-cloud-tripleo
          NODEPOOL_CLOUD=rax
          NODEPOOL_REGION=dfw
          NODEPOOL_AZ=
          EOF

# https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/macros.yaml#L883-L889
- wrapper:
    name: build-timeout
    wrappers:
      - timeout:
          timeout: '{timeout}'
          timeout-var: 'BUILD_TIMEOUT'
          fail: true

# https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/macros.yaml#L724-L756
- builder:
    name: net-info
    builders:
      - shell: |
          #!/bin/sh
          export PATH=$PATH:/sbin:/usr/sbin
          if [ -f /etc/dib-builddate.txt ]; then
              echo "Image build date"
              echo "================"
              cat /etc/dib-builddate.txt
          fi
          echo "Host & kernel"
          echo "============="
          uname -a
          echo "Network configuration data..."
          [ -f /mnt/config/openstack/latest/network_info.json ] && python -mjson.tool /mnt/config/openstack/latest/network_info.json
          [ -f /mnt/config/openstack/latest/network_data.json ] && python -mjson.tool /mnt/config/openstack/latest/network_data.json
          [ -f /mnt/config/openstack/latest/vendor_data.json ] && python -mjson.tool /mnt/config/openstack/latest/vendor_data.json
          echo "Network interface addresses..."
          echo "=============================="
          ip address show
          echo "Network routing tables..."
          echo "========================="
          ip route show
          ip -6 route show
          echo "Network neighbors..."
          echo "===================="
          ip neighbor show
          echo "Route to Git mirror..."
          echo "======================"
          traceroute6 -n git.openstack.org \
              || traceroute -n git.openstack.org \
              || true

# https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/macros.yaml#L702-L714
- builder:
    name: devstack-checkout
    builders:
      - shell: |
          #!/bin/bash -xe
          cat > clonemap.yaml << EOF
          clonemap:
            - name: openstack-infra/devstack-gate
              dest: devstack-gate
          EOF
          /usr/zuul-env/bin/zuul-cloner -m clonemap.yaml --cache-dir /opt/git \
              git://git.openstack.org \
              openstack-infra/devstack-gate


- builder:
    name: ci-config-checkout
    builders:
      - shell: |
          git clone https://review.rdoproject.org/r/p/rdo-infra/ci-config.git $WORKSPACE/rdo-infra/ci-config

- builder:
    name: build-containers-images
    builders:
      - shell: |
          export RELEASE={release}
          bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/build-containers-images.sh

- builder:
    name: images-upload-and-label
    builders:
      - shell: |
          export RELEASE={release}
          mkdir -p $WORKSPACE/logs/images-upload/
          bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/convert-upload-undercloud.sh
          bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/upload-cloud-images.sh
          echo export UPLOAD_EXIT_VALUE=$? >> $WORKSPACE/hash_info.sh
          cp $HOME/.__repo_setup.sh.log $WORKSPACE/logs/images-upload

- builder:
    name: get-hash
    builders:
      - shell: |
          export RELEASE={release}
          export PROMOTE_NAME={promote_name}
          bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/get-hash.sh

- builder:
    name: promote-hash
    builders:
      - shell: |
          export RELEASE={release}
          export PROMOTE_NAME={promote_name}
          bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/promote-hash.sh

- builder:
    name: toci-test
    builders:
      - shell: |
          #!/bin/bash -xe

          export TOCI_JOBTYPE={type}

          # ZUUL Does not set these for periodic jobs
          export ZUUL_BRANCH=${{ZUUL_BRANCH:-master}}
          export ZUUL_REF=${{ZUUL_REF:-None}}

          export BRANCH_OVERRIDE={branch-override}
          if [ "$BRANCH_OVERRIDE" != "default" ] ; then
              export OVERRIDE_ZUUL_BRANCH=$BRANCH_OVERRIDE
          fi

          export PYTHONUNBUFFERED=true
          export DEVSTACK_GATE_TEMPEST=0
          export DEVSTACK_GATE_EXERCISES=0
          export DEVSTACK_GATE_HORIZON=1
          export PROJECTS="openstack/tripleo-quickstart $PROJECTS"
          export PROJECTS="openstack/tripleo-quickstart-extras $PROJECTS"
          export PROJECTS="openstack/tripleo-upgrade $PROJECTS"

          sudo chown -hR $(whoami) /opt/git
          function gate_hook {{
              bash -xe /opt/stack/new/tripleo-ci/toci_gate_test.sh
          }}
          export -f gate_hook
          cp devstack-gate/devstack-vm-gate-wrap.sh ./safe-devstack-vm-gate-wrap.sh
          ./safe-devstack-vm-gate-wrap.sh

# https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/macros.yaml#L941-L950
# devstack-logs can be brought back after Software-Factory has been upgraded to
# 2.6 if need be.
#- publisher:
#    name: devstack-logs
#    publishers:
#      - scp:
#          site: 'logs.rdoproject.org'
#          files:
#            - target: '$LOG_PATH'
#              source: 'logs/**'
#              keep-hierarchy: true
#              copy-after-failure: true

# TripleO Quickstart gate jobs
# https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/tripleo.yaml#L107-L198
#

- job-template:
    name: "periodic-tripleo-centos-7-{release}-promote-consistent-to-tripleo-ci-testing{suffix}"
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - text:
           credential-id: d3a88c21-2575-4756-9bd7-aeda904171bc
           variable: DLRNAPI_PASSWORD
        - text:
           credential-id: f80d1c45-82f7-47c7-a463-7c99c27be09c
           variable: REGISTRY_PASSWORD
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: SSH_KEY
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
    defaults: rdo-global
    builders:
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - get-hash:
          release: "{release}"
          promote_name: "consistent"
      - promote-hash:
          release: "{release}"
          promote_name: "tripleo-ci-testing"
    publishers:
      - rdo-rsync-logs

- job-template:
    name: "periodic-tripleo-centos-7-{release}-containers-build{suffix}"
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - text:
           credential-id: d3a88c21-2575-4756-9bd7-aeda904171bc
           variable: DLRNAPI_PASSWORD
        - text:
           credential-id: f80d1c45-82f7-47c7-a463-7c99c27be09c
           variable: REGISTRY_PASSWORD
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: SSH_KEY
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
    defaults: rdo-global
    builders:
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - get-hash:
          release: "{release}"
          promote_name: "tripleo-ci-testing"
      - toci-test:
          type: 'periodic-singlenode-featureset023'
          branch-override: "{branch-override}"
          promote_name: "tripleo-ci-testing"
      - build-containers-images:
          release: "{release}"
    publishers:
      - postbuildscript:
          builders:
            - shell: |
                  mkdir -p $WORKSPACE/logs
                  cp -a /tmp/kolla $WORKSPACE/logs/

                  # Ensure permissions allow artifact uploading
                  sudo chown -R "$(id -u).$(id -g)" $WORKSPACE/logs
          script-only-if-succeeded: False
          script-only-if-failed: False
      - collect-tripleo-logs
      - rdo-rsync-logs

- job-template:
    name: "experimental-tripleo-centos-7-{release}-containers-build{suffix}"
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - text:
           credential-id: d3a88c21-2575-4756-9bd7-aeda904171bc
           variable: DLRNAPI_PASSWORD
        - text:
           credential-id: f80d1c45-82f7-47c7-a463-7c99c27be09c
           variable: REGISTRY_PASSWORD
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: SSH_KEY
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
    defaults: rdo-global
    builders:
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - get-hash:
          release: "{release}"
          promote_name: "tripleo-ci-testing"
      - build-containers-images:
          release: "{release}"
    publishers:
      - postbuildscript:
          builders:
            - shell: |
                  mkdir -p $WORKSPACE/logs
                  cp -a /tmp/kolla $WORKSPACE/logs/

                  # Ensure permissions allow artifact uploading
                  sudo chown -R "$(id -u).$(id -g)" $WORKSPACE/logs
          script-only-if-succeeded: False
          script-only-if-failed: False
      - rdo-rsync-logs

- job-template:
    name: 'periodic-tripleo-ci-{jobname}-{release}{suffix}'
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - text:
           credential-id: d3a88c21-2575-4756-9bd7-aeda904171bc
           variable: DLRNAPI_PASSWORD
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
        - file:
           credential-id: dc7c94c8-232e-4f5c-8e7f-d31a9112fbb7
           variable: EXTRA_NODE_SSH_KEY
    defaults: rdo-global
    builders:
      #- link-logs
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - get-hash:
          release: "{release}"
          promote_name: "tripleo-ci-testing"
      - toci-test:
          type: "{type}"
          branch-override: "{branch-override}"
          promote_name: "tripleo-ci-testing"
    publishers:
      - postbuildscript:
          builders:
            - shell: |
                source $WORKSPACE/hash_info.sh
                export TOCI_JOBTYPE={type}
                export SUCCESS=$([[ "$JOB_EXIT_VALUE" == 0 ]] && echo true || echo false)
                bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/dlrnapi_report.sh
          script-only-if-succeeded: False
          script-only-if-failed: False
      - collect-tripleo-logs
      - rdo-rsync-logs

- job-template:
    name: 'periodic-tripleo-ci-{jobname}-{release}{suffix}-upload'
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - text:
           credential-id: d3a88c21-2575-4756-9bd7-aeda904171bc
           variable: DLRNAPI_PASSWORD
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: SSH_KEY
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
    defaults: rdo-global
    builders:
      #- link-logs
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - get-hash:
          release: "{release}"
          promote_name: "tripleo-ci-testing"
      - toci-test:
          type: "{type}"
          branch-override: "{branch-override}"
          promote_name: "tripleo-ci-testing"
      - images-upload-and-label:
          release: "{release}"
    publishers:
      - postbuildscript:
          builders:
            - shell: |
                source $WORKSPACE/hash_info.sh
                export TOCI_JOBTYPE={type}
                export SUCCESS=$([[ "$JOB_EXIT_VALUE" == 0 && "$UPLOAD_EXIT_VALUE" == 0  ]] && echo true || echo false)
                bash -xe $WORKSPACE/rdo-infra/ci-config/ci-scripts/tripleo-upstream/dlrnapi_report.sh
          script-only-if-succeeded: False
          script-only-if-failed: False
      - collect-tripleo-logs
      - rdo-rsync-logs

- job-template:
    name: '{trigger}-tripleo-ci-{jobname}-{release}{suffix}'
    node: '{node}'
    wrappers:
      - build-timeout:
          timeout: '{timeout}'
      - timestamps
      - credentials-binding:
        - file:
           credential-id: 4b4632bd-f44b-446d-a8ca-b57eabef0a7c
           variable: LOG_SSH_KEY
        - file:
           credential-id: 9dab46dd-ef91-429a-b040-c70937367f7a
           variable: INFLUXDB_PASSWORD
        - file:
           credential-id: dc7c94c8-232e-4f5c-8e7f-d31a9112fbb7
           variable: EXTRA_NODE_SSH_KEY
    defaults: rdo-global
    builders:
      #- link-logs
      - net-info
      - rdo-prepare-workspace
      - rdo-log-setup
      - devstack-checkout
      - ci-config-checkout
      - hack-nodepool-provider-setup
      - toci-test:
          type: "{type}"
          branch-override: "{branch-override}"
          promote_name: "current-tripleo"
    publishers:
      - collect-tripleo-logs
      - rdo-rsync-logs

- project:
    # https://github.com/openstack-infra/project-config/blob/cafc121a627a812302fc8414c3faa751e30043f2/jenkins/jobs/projects.yaml#L15221-L15229
    name: tripleo-quickstart
    jobs:
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-undercloud-oooq'
          release: master
          suffix: '-nv'
          type: 'singlenode-featureset003'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset001'
          release:
            - master
            - pike
            - ocata
            - queens
          suffix: ''
          type: 'ovb-3ctlr_1comp-featureset001'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 300
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset001'
          release:
            - pike
            - ocata
            - queens
          suffix: '-branch'
          type: 'ovb-3ctlr_1comp-featureset001'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 300
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp_1ceph-featureset024'
          release:
            - pike
            - ocata
          suffix:
            - ''
            - '-nv'
          type: 'ovb-1ctlr_1comp_1ceph-featureset024'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 300
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset022'
          release: pike
          suffix: ''
          type: 'ovb-1ctlr_1comp-featureset022'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 300
      - 'periodic-tripleo-centos-7-{release}-promote-consistent-to-tripleo-ci-testing{suffix}':
          release: master
          suffix: ''
          triggers:
            - zuul
          node: upstream-centos-7
          branch-override: default
          timeout: 30
      - 'periodic-tripleo-centos-7-{release}-promote-consistent-to-tripleo-ci-testing{suffix}':
          release:
            - pike
            - ocata
            - queens
          suffix: ''
          triggers:
            - zuul
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 30
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}-upload':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset002'
          release: master
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp-featureset002'
          node: upstream-centos-7
          branch-override: default
          timeout: 240
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}-upload':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset002'
          release:
            - pike
            - ocata
            - queens
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp-featureset002'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 240
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset035'
          release: master
          suffix: ''
          type: 'periodic-ovb-3ctlr_1comp-featureset035'
          node: upstream-centos-7
          branch-override: default
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset035'
          release:
            - queens
          suffix: ''
          type: 'periodic-ovb-3ctlr_1comp-featureset035'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset001'
          release: master
          suffix: ''
          type: 'periodic-ovb-3ctlr_1comp-featureset001'
          node: upstream-centos-7
          branch-override: default
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset001'
          release:
            - pike
            - ocata
            - queens
          suffix: ''
          type: 'periodic-ovb-3ctlr_1comp-featureset001'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset022'
          release: pike
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp-featureset022'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset020'
          release: master
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp-featureset020'
          node: upstream-centos-7
          branch-override: default
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset020'
          release:
            - pike
            - ocata
            - queens
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp-featureset020'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 300
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp_1ceph-featureset024'
          release: pike
          suffix: ''
          type: 'periodic-ovb-1ctlr_1comp_1ceph-featureset024'
          node: upstream-centos-7
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset005'
          release: pike
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset005'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset006'
          release: pike
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset006'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset007'
          release: pike
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset007'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset008'
          release: pike
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset008'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-centos-7-{release}-containers-build{suffix}':
          suffix: ''
          release:
            - master
          node: upstream-centos-7
          triggers:
            - zuul
          branch-override: default
          timeout: 240
      - 'experimental-tripleo-centos-7-{release}-containers-build{suffix}':
          suffix: ''
          release:
            - master
          node: upstream-centos-7
          triggers:
            - zuul
          branch-override: default
          timeout: 240
      - 'periodic-tripleo-centos-7-{release}-containers-build{suffix}':
          suffix: ''
          release:
            - pike
            - queens
          node: upstream-centos-7
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 240
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset010'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset010'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset010'
          release:
            - pike
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset010'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset016'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset016'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset016'
          release:
            - pike
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset016'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset017'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset017'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset017'
          release:
            - pike
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset017'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset018'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset018'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset018'
          release:
            - pike
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset018'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset019'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset019'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset019'
          release:
            - pike
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset019'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-singlenode-featureset027'
          release: master
          suffix: ''
          type: 'periodic-singlenode-featureset027'
          node: upstream-centos-7
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset030'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset030'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset030'
          release:
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset030'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset037-updates'
          release: master
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset037'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: default
          timeout: 180
      - 'periodic-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset037-updates'
          release:
            - queens
          suffix: ''
          type: 'periodic-multinode-1ctlr-featureset037'
          node: upstream-centos-7-2-node
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 180
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset036-oc-ffu'
          release: queens
          suffix: '-nv'
          type: 'multinode-1ctlr-featureset036'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-containers-multinode-upgrades'
          release:
            - pike
          suffix: '-branch-nv'
          type: 'multinode-1ctlr-featureset011'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-containers-multinode-upgrades'
          release:
            - pike
          suffix: '-nv'
          type: 'multinode-1ctlr-featureset011'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-container-to-container-upgrades'
          release:
            - queens
            - master
          suffix:
            - '-nv'
            - ''
          type: 'multinode-1ctlr-featureset040'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-container-to-container-featureset051-upgrades'
          release:
            - master
          suffix:
            - ''
          type: 'multinode-1ctlr-featureset051'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360

      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset017'
          release: master
          suffix: ''
          type: 'multinode-1ctlr-featureset017'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset018'
          release: master
          suffix: ''
          type: 'multinode-1ctlr-featureset018'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset019'
          release: master
          suffix: ''
          type: 'multinode-1ctlr-featureset019'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-1ctlr_1comp-featureset020'
          release: master
          suffix: ''
          type: 'ovb-1ctlr_1comp-featureset020'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-multinode-1ctlr-featureset016'
          release: master
          suffix: ''
          type: 'multinode-1ctlr-featureset016'
          node: upstream-centos-7-2-node
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset021'
          release:
            - ocata
            - pike
            - queens
          suffix: ''
          type: 'ovb-3ctlr_1comp-featureset021'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: 'stable/{release}'
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset021'
          release: master
          suffix: ''
          type: 'ovb-3ctlr_1comp-featureset021'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset035'
          release:
            - master
            - queens
          suffix: ''
          type: 'ovb-3ctlr_1comp-featureset035'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp_1supp-featureset039'
          release:
            - master
          suffix: ''
          type: 'ovb-3ctlr_1comp_1supp-featureset039'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360
      - '{trigger}-tripleo-ci-{jobname}-{release}{suffix}':
          jobname: 'centos-7-ovb-3ctlr_1comp-featureset042'
          release:
            - master
            - queens
          suffix:
            - ''
            - '-nv'
            - '-tht'
            - '-tht-nv'
          type: 'ovb-3ctlr_1comp-featureset042'
          node: upstream-centos-7
          trigger: gate
          triggers:
            - zuul
          branch-override: default
          timeout: 360

