- builder:
    name: 'centos-opstools-virtualenv'
    defaults: global
    builders:
      - shell: |
          set -e
          sudo yum -y install python-virtualenv
          virtualenv $ZUUL_PROJECT/venv
          source $ZUUL_PROJECT/venv/bin/activate
          pip install --upgrade pip tox

- builder:
    name: 'centos-opstools-bindeps'
    defaults: global
    builders:
      - shell: |
          set -e
          sudo yum -y install centos-release-openstack-newton
          sudo yum -y install libffi-devel openssl-devel libyaml-devel

- job:
    name: 'centos-opstools-tox'
    defaults: global
    builders:
      - prepare-workspace
      - centos-opstools-bindeps
      - centos-opstools-virtualenv
      - shell: |
          set -e
          source $ZUUL_PROJECT/venv/bin/activate
          pushd $ZUUL_PROJECT
          tox
          popd
    triggers:
      - zuul
    node: bare-centos-7
