diskimages:
  - name: dib-centos-7
    elements:
      - centos-minimal
      - nodepool-minimal
      - sf-release # This installs centos-release-openstack-newton, centos-release-opstools and sf repository
      - sf-zuul-worker
      - jenkins-worker
      - rpm-factory
      - ansible
      - common-packages
  - name: upstream-centos-7
    formats:
      - qcow2
    elements:
      - centos-minimal
      - vm
      - simple-init
      - openstack-repos
      - nodepool-base
      - cache-devstack
      - growroot
      - infra-package-needs
      - epel
      - persist-nodepool-mirror-host
    env-vars:
      QEMU_IMG_OPTIONS: compat=0.10
      DIB_GRUB_TIMEOUT: '0'
      DIB_EPEL_DISABLED: '1'
      NODEPOOL_SSH_KEY: >-
        AAAAB3NzaC1yc2EAAAADAQABAAABAQCp9iFXvR6UoWYboU41KFpx+Sdd7ov0i+szIjdB7p8LAR5mjVCWZWAyUSE16DQO0VRbl6FpxFUPRQCUXg5P59D6MjRPB+lIvAyZ53CkgVfkaKYNdLQKRoyBR0Q5ng0Gt74AwU7fo0lyVa9MYsxAVbwrE0ngrqzGA1Lm5TSAmZeURZLch65xZm8qc5UU2TZ9f9NEwdZgKFAplBT2Om+DdECNO+TRy/RAivBFmZangQBnBEp4cOiverur22Lc2MO4veBVT+pvTWI0YNKFPmwRpgfWTsZ6R1sUOHCIXmK+P8nR/BMAF/+XXNdEg4RTJFCNP5nWiSUpMj3z6dvQ0zv1twgb
      ELEMENTS_PATH: /opt/git/openstack-infra/project-config/nodepool/elements:/etc/nodepool/elements
      NODEPOOL_SCRIPTDIR: /opt/git/openstack-infra/project-config/nodepool/scripts
      # bluebox-sjc2 is closer than rax-dfw from Phoenix
      # (where rdo-cloud is located) but rax-dfw is tuned for higher capacity
      NODEPOOL_MIRROR_HOST: mirror.dfw.rax.openstack.org

labels:
  - name: dib-centos-7
    min-ready: 1
    image: dib-centos-7
    providers:
      - name: rcip-dev
  - name: bare-centos-7
    min-ready: 4
    image: bare-centos-7
    providers:
      - name: rdo-cloud
  - name: upstream-centos-7
    min-ready: 1
    image: upstream-centos-7
    ready-script: configure_mirror.sh
    providers:
      - name: rdo-cloud-tripleo
  - name: bare-centos-7-2-node
    min-ready: 0
    image: bare-centos-7
    providers:
      - name: rcip-dev
    ready-script: multinode_setup.sh
    subnodes: 1
  - name: rdo-weirdo-centos-7
    image: rdo-weirdo-centos-7
    min-ready: 3
    providers:
      - name: rcip-dev

providers:
  - name: rcip-dev
    boot-timeout: 120
    clean-floating-ips: true
    cloud: rcip-dev
    max-servers: 18
    pool: public
    rate: 2.0
    images:
      - name: dib-centos-7
        diskimage: dib-centos-7
        username: jenkins
        min-ram: 2048
      - name: bare-centos-7
        base-image: CentOS 7 (1701) x86_64
        setup: rdo-base.sh
        name-filter: m1.rdo-ci
        username: centos
        min-ram: 8192
      - name: rdo-weirdo-centos-7
        base-image: CentOS 7 (1701) x86_64
        setup: rdo-weirdo.sh
        name-filter: m1.rdo-ci
        username: centos
        min-ram: 8192
  - name: trystack
    boot-timeout: 120
    clean-floating-ips: true
    cloud: trystack
    max-servers: 9
    pool: public
    rate: 2.0
    images:
      - name: bare-centos-7
        base-image: CentOS 7 (1701) x86_64
        setup: rdo-base.sh
        name-filter: m1.rdo-ci
        username: centos
        min-ram: 8192
  - name: rdo-cloud
    boot-timeout: 120
    clean-floating-ips: true
    cloud: rdo-cloud
    max-servers: 30
    pool: public
    rate: 1.0
    networks:
      - name: private
    images:
      - name: bare-centos-7
        base-image: CentOS 7 (1701) x86_64
        setup: rdo-base.sh
        name-filter: rdo.m1.medium
        username: centos
        min-ram: 4096
  - name: rdo-cloud-tripleo
    boot-timeout: 120
    clean-floating-ips: true
    cloud: rdo-cloud-tripleo
    max-servers: 30
    pool: public
    rate: 1.0
    networks:
      - name: private
    images:
      - name: upstream-centos-7
        diskimage: upstream-centos-7
        name-filter: ci.m1.nodepool
        username: jenkins
        min-ram: 8192
