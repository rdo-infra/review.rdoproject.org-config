---
# More info: https://bugs.launchpad.net/tripleo/+bug/2015309
- name: Ensure gnupg2 package is installed
  when: ansible_distribution_major_version | int > 8
  block:
    - name: Install gnupg2
      become: true
      ansible.builtin.yum:
        name: gnupg2-2.3.3-2.el9.x86_64
        state: present
        allow_downgrade: true

    - name: Add the gnupg2 to exclude
      become: true
      ansible.builtin.lineinfile:
        path: /etc/yum.conf
        regexp: '^exclude='
        line: "exclude=gnupg2*"
