---
- name: Fail when openshift_pull_sec not provided
  ansible.builtin.fail:
    msg: "The openshift_pull_secret variable can not be empty!"
  when: crc_secret_pabrodri.openshift_pull_secret | length == 0

# if some images in the operators have changed, it will stuck here.
- name: Copy pull-secret to kubelet config.json to avoid stuck on crc-cloud setup
  become: true
  ansible.builtin.copy:
    content: |
      {{ crc_secret_pabrodri.openshift_pull_secret }}
    dest: /var/lib/kubelet/config.json
  when: crc_secret_pabrodri.openshift_pull_secret | length > 0
  no_log: true
