---
- name: Reboot host after adding network infterfaces
  become: true
  ansible.builtin.reboot:
    reboot_timeout: 900

- name: Start Zuul console after reboot
  include_role:
    name: start-zuul-console

- name: Get running services
  ansible.builtin.service_facts:

- name: Ensure dnsmasq is running
  when: "'crc-dnsmasq.service' not in services"
  become: true
  ansible.builtin.service:
    name: dnsmasq
    state: started

- name: Ensure crc-dnsmasq is running when legacy
  when: "'crc-dnsmasq.service' in services"
  become: true
  ansible.builtin.service:
    name: crc-dnsmasq
    state: restarted
